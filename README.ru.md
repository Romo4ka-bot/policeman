# Policeman Service

Читать на других языках: [English](README.md), [Русский](README.ru.md)

Это сервис, предназначен для получения случайного или последовательного автомобильного номера формата `A000AA 116 RUS`, 
где A - любой символ из списка `[А, Е, Т, О, Р, Н, У, К, Х, С, В, М]`, 1 - любая цифра, `116 RUS` - константа.

Была выбрана СУБД MongoDB, потому что она, как правило, обеспечивает высокую производительность при операциях вставки и чтения.

## Локальный запуск сервиса

1) Перед запуском сервиса нужно сначала собрать jar командой:

```bash
mvn package
```

2) В сервисе используется Docker, поэтому для запуска достаточно прописать команду ниже.

```bash
docker-compose up --build -d
```

У вас поднимутся два контейнера(приложение и бд MongoDB), описанные в файле docker-compose.yml в корне проекта. 
Для проверки, что контейнеры успешно поднялись, можете написать команду ниже и посмотрите статус(Up).

```bash
docker ps
```

3) Вы можете остановить сервис с помощью команду:

```bash
docker-compose stop
```

## Основной функционал:
1) Получение случайного номера
    * урл: /api/v1/numbers/random GET
    * входящее значение: В хидере запроса должен приходить токен аутенфикации
    * возвращаемое значение: строка с content-type - text/plain (например: `A000AA 116 RUS`)
2) Получение следующего номера
    * урл: /api/v1/numbers/next GET
    * входящее значение: В хидере запроса должен приходить токен аутенфикации
    * возвращаемое значение: строка с content-type - text/plain (например: `A000AA 116 RUS`)

Более подробное описание можно посмотреть в свагере и протестировать запросы. Swagger Url: http://localhost:8080/swagger-ui/index.html.

Также в файле [requests.http](requests.http), находящийся в корне проекта, были написаны примеры запросов, 
которые можно запустить удобной для вас среде разработки или любым другим способом.

### Список библиотек и технологий, которые использовались для создания сервиса:
   * [spring boot](https://spring.io/projects/spring-boot) в качестве основого веб-фреймворка
   * [jjwt](https://github.com/jwtk/jjwt) для написания JWT аутенфикации
   * [modelmapper](https://modelmapper.org) для мапинга сущностей
   * [swagger-v3](https://swagger.io/specification/) swagger для описания API
   * [testcontainers](https://testcontainers.com) библиотека предоставляющая возможности запсука тест контейнеров для проведения интеграционных тестов
   * СУБД MongoDb
   * Docker, docker-compose

## Запуск тестов

Были написаны интеграционные тесты для [CarNumberController.java](#src/main/java/ru/inovus/policeman/controller/CarNumberController.java), которые можно найти в папке `src/test`

```bash
mvn test
```

Также тесты можно запустить через интерфейс среды разработки, например Intellij Idea.

## Фреймворк сборки

   * [Maven](https://maven.apache.org)